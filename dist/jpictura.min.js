function heightCalculator(t,i,a){function e(t){n(t),s(t),o()}function n(t){var i=0,a=d.optimum,e=d.maxWidthHeightRatio;u=t/((t-i)/a+e)}function s(t){var i=0,a=d.optimum,e=d.maxWidthHeightRatio;e*a>t?(d.debug&&c("The max width/height ratio "+e+" is too big for row width "+t+"px."),g=t*e):g=t/((t+i)/a-e)}function r(t,i){var a,e,n=0;do a=m(t,h,!1,d),a>i?g=h:u=h,o(u,g),e=!1,a>i&&(e=!0),i-a>d.guessingAlgorithm.epsilon&&(e=!0),++n>=d.guessingAlgorithm.maxIterationCount&&(e=!1);while(e);return n>=d.guessingAlgorithm.maxIterationCount&&d.debug&&c("Max "+n+" iterations reached. Current precision: "+(i-a)+"."),h}function o(){h=(u+g)/2}function l(t,i,a){t=Math.floor(t);var e;do e=m(i,t,!0,d);while(a>e&&t++);return t}var u,g,h,c=i,m=t,d=a;this.getHeight=function(t,i){if(0===t.length)return 0;e(i);var a=r(t,i);return a=l(a,t,i)}}/*!
 * jPictura v1.0.0
 * https://github.com/anmarcek/jpictura.git
 *
 * Copyright (c) 2014-2016 Anton Marček
 * Released under the MIT license
 *
 * Date: 2016-02-02T11:43:10.590Z
 */
!function(t){function i(t,i){t.addClass(i.containerCssClass),i.fadeInItems&&t.addClass("fade-in-items"),i.stretchImages&&t.addClass("stretch-images"),i.centerImages&&t.addClass("center-images");var e=t.find(i.itemSelector);e.addClass(i.itemCssClass),e.addClass("invisible");var s=e.find(i.imageSelector);s.addClass(i.imageCssClass),a(t,e,i,n)}function a(t,i,a,n){a.waitForImages?e(t,i,a,n):n(t,i,a)}function e(i,a,e,n){function s(){++r===a.size()&&n(i,a,e)}var r=0;a.find(e.imageSelector).each(function(){var i=new Image;i.src=t(this).attr("src"),i.onload=s()})}function n(i,a,e){var n=(new Date).getTime(),u=a.size(),g=[],h=i.width()-e.rowPadding,c=new e.heightCalculator(l,m,e);a.each(function(i){var a=t(this),n=i+1===u;if(0===g.length)g.push(a);else{var l=g.slice(0);if(l.push(a),s(l,h,e)){var m=r(g,h,c,e),d=r(l,h,c,e),f=t.fn.jpictura.evaluate(m,e),C=t.fn.jpictura.evaluate(d,e);f>C?g.push(a):(o(g,h,m,n,e),g=[],g.push(a))}else g.push(a)}});var d=s(g,h,e)||e.justifyLastRow?r(g,h,c,e):e.optimum;o(g,h,d,!0,e);var f=(new Date).getTime();e.debug&&m("Gallery created in "+(f-n)+" milliseconds.")}function s(t,i,a){for(var e=(t.length-1)*a.itemSpacing,n=0;n<t.length;n++)e+=g(t[n],a.optimum,a);return e>i}function r(t,i,a,e){var n=u(t,i,e),s=a.getHeight(t,n);return s}function o(t,i,a,e,n){var s=l(t,a,!0,n),r=u(t,i,n),o=s-r,h=t.slice(0);h.sort(function(t,i){return g(i,a,n)-g(t,a,n)});for(var c=o,m=0;m<h.length;m++){var d,f=h[m],C=g(f,a,n);c>=0?(d=Math.ceil(C/r*o),d>c&&(d=c),c-=d):d=0,C=Math.floor(C)-d,f.width(C),f.height(a),f.removeClass("invisible");var v=f===t[0],p=f===t[t.length-1];if(f.toggleClass(n.lastRowCssClass,e),f.toggleClass(n.firstInRowCssClass,v),f.toggleClass(n.lastInRowCssClass,p),n.applyItemSpacing&&(p||f.css("margin-right",n.itemSpacing+"px"),f.css("margin-bottom",n.itemSpacing+"px")),n.centerImages){var w=f.find(n.imageSelector);Math.abs(C-w.width())>1&&w.addClass("centered-horizontally"),Math.abs(a-w.height())>1&&w.addClass("centered-vertically")}}}function l(t,i,a,e){for(var n=0,s=0;s<t.length;s++){var r=g(t[s],i,e);a&&(r=Math.floor(r)),n+=r}return n}function u(t,i,a){return i-(t.length-1)*a.itemSpacing}function g(t,i,a){var e=h(t,a)*i;return e}function h(t,i){var a=f+"-ratio",e=t.data(a);return void 0===e&&(e=c(t,i),t.data(a,e)),e<=i.minWidthHeightRatio?i.minWidthHeightRatio:e>=i.maxWidthHeightRatio?i.maxWidthHeightRatio:e}function c(t,i){var a=t.data(f+"-width"),e=t.data(f+"-height");if(void 0===a||void 0===e){var n=t.find(i.imageSelector);a=n.prop("naturalWidth"),e=n.prop("naturalHeight")}var s=a/e;return s}function m(t){window.console&&console.log(d+": "+t)}t.fn.jpictura=function(a){var e=t.extend({},t.fn.jpictura.defaults,a);return this.each(function(){i(t(this),e)}),this};var d="jPictura",f=d.toLowerCase();t.fn.jpictura.defaults={containerCssClass:f,itemCssClass:f+"-item",lastRowCssClass:f+"-last-row",firstInRowCssClass:f+"-first-in-row",lastInRowCssClass:f+"-last-in-row",imageCssClass:f+"-image",itemSelector:".item",imageSelector:"img",rowPadding:0,itemSpacing:0,applyItemSpacing:!0,optimum:180,minWidthHeightRatio:1/3,maxWidthHeightRatio:3,guessingAlgorithm:{epsilon:.01,maxIterationCount:100},waitForImages:!0,fadeInItems:!1,stretchImages:!0,centerImages:!1,justifyLastRow:!1,debug:!1,heightCalculator:heightCalculator},t.fn.jpictura.evaluate=function(t,i){return Math.abs(t-i.optimum)}}(jQuery);